<div class="home-container">
  <div class="hero">
    <h1>Plataforma E-learning</h1>
    <p>Aprenda, ensine e acompanhe seu progresso em um só lugar.</p>
  </div>

  <div class="card">
    <h2>{{ isEditMode ? 'Editar Curso' : 'Cadastro de Curso' }}</h2>
    <p>Preencha os dados do curso</p>

    @if (isLoading()) {
      <div style="text-align: center; padding: 20px;">
        <mat-spinner diameter="40"></mat-spinner>
      </div>
    } @else {
      <form [formGroup]="form" (ngSubmit)="onSubmit()">

        <div class="form-group">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Título do Curso</mat-label>
            <input matInput formControlName="title" placeholder="Ex: Desenvolvimento Web Completo">
            <mat-hint>Mínimo 5 caracteres, máximo 150</mat-hint>
            <mat-error *ngIf="form.get('title')?.hasError('required')">
              Título é obrigatório
            </mat-error>
            <mat-error *ngIf="form.get('title')?.hasError('minlength')">
              Mínimo de 5 caracteres
            </mat-error>
            <mat-error *ngIf="form.get('title')?.hasError('maxlength')">
              Máximo de 150 caracteres
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Descrição</mat-label>
            <textarea
              matInput
              formControlName="description"
              rows="4"
              placeholder="Descreva o conteúdo do curso"></textarea>
            <mat-hint>Mínimo 20 caracteres</mat-hint>
            <mat-error *ngIf="form.get('description')?.hasError('required')">
              Descrição é obrigatória
            </mat-error>
            <mat-error *ngIf="form.get('description')?.hasError('minlength')">
              Mínimo de 20 caracteres
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Carga Horária (horas)</mat-label>
            <input matInput type="number" formControlName="workload" placeholder="Ex: 40">
            <mat-hint>Mínimo 10 horas</mat-hint>
            <mat-error *ngIf="form.get('workload')?.hasError('required')">
              Carga horária é obrigatória
            </mat-error>
            <mat-error *ngIf="form.get('workload')?.hasError('min')">
              Valor mínimo é 10 horas
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>URL da Imagem</mat-label>
            <input matInput formControlName="imageUrl" placeholder="https://exemplo.com/imagem.jpg">
            <mat-hint>URL completa da imagem do curso</mat-hint>
            <mat-error *ngIf="form.get('imageUrl')?.hasError('required')">
              URL da imagem é obrigatória
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Preço (R$)</mat-label>
            <input matInput type="number" formControlName="price" placeholder="199.90" step="0.01">
            <mat-error *ngIf="form.get('price')?.hasError('required')">
              Preço é obrigatório
            </mat-error>
            <mat-error *ngIf="form.get('price')?.hasError('min')">
              Preço deve ser positivo
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Preço Antigo (R$)</mat-label>
            <input matInput type="number" formControlName="oldPrice" placeholder="299.90" step="0.01">
            <mat-hint>Opcional</mat-hint>
            <mat-error *ngIf="form.get('oldPrice')?.hasError('min')">
              Preço deve ser positivo
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Categorias</mat-label>
            <mat-select formControlName="categoryIds" multiple>
              @if (categories().length === 0) {
                <mat-option disabled>Nenhuma categoria disponível</mat-option>
              } @else {
                @for (cat of categories(); track cat.id) {
                  <mat-option [value]="cat.id">{{ cat.name }}</mat-option>
                }
              }
            </mat-select>
            <mat-hint>Selecione pelo menos uma categoria</mat-hint>
            <mat-error *ngIf="form.get('categoryIds')?.hasError('required')">
              Selecione ao menos uma categoria
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group checkbox-group">
          <mat-checkbox formControlName="isBestSeller">
            Marcar como "Mais Vendido"
          </mat-checkbox>
        </div>

        <div class="button-group">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="form.invalid || isLoading()">
            {{ isEditMode ? 'Atualizar' : 'Criar Curso' }}
          </button>

          <button
            mat-raised-button
            type="button"
            (click)="cancel()">
            Cancelar
          </button>
        </div>
      </form>
    }
  </div>

  <footer class="footer">© Plataforma E-learning</footer>
</div>
